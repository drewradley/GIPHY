<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>GIPHY Searcher</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <style type="text/css">
    button,
    div,
    form,
    input {
      margin: 10px;
    }
    .jumbotron{
      background-color: rgb(7, 7, 7);
      text-align: center;
      box-align: center;
      /* margin-left: 500px; */
    }
    .col-4
    {
      text-align: center;
    }
    .card-text
    {
      text-align: left;
    }
    .card-img-top
    {
      position: relative;
      top: 15px;
    }
    .card
    {
      margin: 10px;
      margin-left: 60px;
      background-color: gray
    }
    .card-title
    {
      text-align: left;
      color: brown;
    }
  </style>
</head>

<body>

  <div class="container">
    <h1>Goth GIF Search</h1>
    <hr>
    <!-- Movies will get dumped here -->
    
    <div id="buttons-view"></div>
    <hr>
    <form id="movie-form">
      <label for="movie-input">What would you like to GIPHY today?</label>
      <input type="text" class="form-control" id="movie-input">
      

      <!-- Button triggers new movie to be added -->
      <input id="add-movie" type="submit" value="Add Button" class="btn btn-warning">
    </form>
    <div id="movies-view">
        
      
    </div>
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
          <div  style="width: 18rem;"></div> 
          <center><div class="row chicken">
          </center>
        </div>
    </div>
    <hr>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">


      var movies = ["goth", "Robert Smith", "Siouxsie", "Sisters of Mercy"];
      var img = $('<img>');
      var imgStatic = $('<img>');
      var paused = true;
      $('.jumbotron').hide();

      
      function renderButtons() {
        $("#movie-input").val("")
        $("#buttons-view").empty();
        for(var i=0;i<movies.length;i++)
        {
          createInput(); 
          function createInput(){
             var input = $(`<input type="button" value="${movies[i]}" class ="buttonM btn btn-primary"/>`)
              input.appendTo($("#buttons-view"));
            }
          
          
        }

        
      }
      function alertMovieName() {
        $('.jumbotron').show();
        $("#movies-view").empty();
        $(".chicken").empty();
        var queryURL = `https://api.giphy.com/v1/gifs/search?q=${$(this).attr("value")}&api_key=dc6zaTOxFJmzC&limit=10`;

        $.ajax({
      url: queryURL,
      method: "GET"
    }).then(function(response) {
      var gifs = response.data;
      
      gifs.forEach(function(gif) {
        row=$('<div>');
          row.addClass("row")
        column=$('<div>');
          column.addClass("col-4 card")
        div=$('<div>');
          div.addClass("card-body")
        card=$('<div>');
          card.addClass("card")
        img =$('<img>');
          img.addClass("GIFme card-img-top")
        // console.log(gif.title)
          img.attr('src',gif.images.fixed_height_still.url);
          img.attr('alt',gif.title);
       
       
     $('.chicken').append(column);
          column.append(img);
          column.append(div);
          div.append(`<h5 class="card-title">Rated ${gif.rating.toUpperCase()}</h5>`)
          div.append(`<p class="card-text"> ${gif.title}</p>`)

      })
    });

      }

      $(document).on('click', '.GIFme', function() {
        
        var src = $(this).attr("src");
          if($(this).hasClass('playing')){
        //stop
        $(this).attr('src', src.replace(/\.gif/i, "_s.gif"))
            $(this).removeClass('playing');
          } else {
        //play
              $(this).addClass('playing');
              $(this).attr('src', src.replace(/\_s.gif/i, ".gif"))
      }
    });      
      $(document).on("click", ".buttonM", alertMovieName);

      $("#add-movie").on("click", function(event) {

        // event.preventDefault() prevents submit button from trying to send a form.
        // Using a submit button instead of a regular button allows the user to hit
        // "Enter" instead of clicking the button if desired
        event.preventDefault();
        var mM = $("#movie-input").val().trim();
        
        for(var i=0;i<movies.length; i++)
        {
          if(mM.toLowerCase()==movies[i].toLowerCase()||mM=="")
          {
            return;
          }
        }
        if (mM!=="")
        {
                 
          movies.push(mM);
        
        // Write code to grab the text the user types into the input field
        // Write code to add the new movie into the movies array

        // The renderButtons function is called, rendering the list of movie buttons
        
        renderButtons();
       
      }
      });

      // Calling the renderButtons function to display the initial list of movies
      renderButtons();
    </script>
  </div>
</body>

</html>
